// MWReBar.cpp: implementation of the CMWReBar class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "MidiGlassApp.h"
#include "MWReBar.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

IMPLEMENT_DYNAMIC(CMWReBar, CReBar)

extern CMidiWorksApp theApp;

//
/////////////////////////////////////////////////////////////////////////////////////
// Construction/Destruction
//
/////////////////////////////////////////////////////////////////////////////////////
BEGIN_MESSAGE_MAP(CMWReBar, CReBar)
    ON_WM_CTLCOLOR()
    ON_WM_ERASEBKGND()
    ON_NOTIFY_REFLECT(NM_CUSTOMDRAW, &CMWReBar::OnNMCustomdraw)
END_MESSAGE_MAP()


//
/////////////////////////////////////////////////////////////////////////////////////
//
/////////////////////////////////////////////////////////////////////////////////////
CMWReBar::CMWReBar()
{
	m_bSendNormal = false;
}

//
/////////////////////////////////////////////////////////////////////////////////////
//
/////////////////////////////////////////////////////////////////////////////////////
CMWReBar::~CMWReBar()
{

}

//
/////////////////////////////////////////////////////////////////////////////////////
//
/////////////////////////////////////////////////////////////////////////////////////
void CMWReBar::SetAnsiVarFont()
{
	::SendMessage ( this->m_hWnd, WM_SETFONT, ( WPARAM ) ( ::GetStockObject ( ANSI_VAR_FONT ) ), 1 );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWReBar::SetAnsiFixedFont()
{
	::SendMessage ( this->m_hWnd, WM_SETFONT, ( WPARAM ) ( ::GetStockObject ( ANSI_FIXED_FONT ) ), 1 );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWReBar::SendNormalMessage()
{
	m_bSendNormal	= true;
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
HBRUSH CMWReBar::OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor)
{
    HBRUSH hbr = CReBar::OnCtlColor(pDC, pWnd, nCtlColor);

    //

    //
    return hbr;
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
BOOL CMWReBar::OnEraseBkgnd(CDC* pDC)
{
    //
	BOOL bRes = FriendEraseBkgnd(this, pDC);
	if ( bRes )
	{
		return bRes;
	}
    return CReBar::OnEraseBkgnd(pDC);
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
BOOL CMWReBar::Create(CWnd* pParentWnd, DWORD dwCtrlStyle , DWORD dwStyle , UINT nID)
{
    //

    return CReBar::Create(pParentWnd, dwCtrlStyle, dwStyle, nID);
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWReBar::OnNMCustomdraw(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMCUSTOMDRAW pNMCD = reinterpret_cast<LPNMCUSTOMDRAW>(pNMHDR);

    //
    NMCUSTOMDRAW* pcd = (NMCUSTOMDRAW*)pNMHDR;

    switch (pcd->dwDrawStage)
    {
        case CDDS_PREPAINT :
        {
            *pResult = CDRF_NOTIFYITEMDRAW;
            return;
        }

        case CDDS_ITEMPREPAINT :
        {
            //  pcd->dwItemSpec Seems To be The IDB
            pcd->dwItemSpec;
            // FillRect(pcd->hdc, &pcd->rc, theApp.m_brBackGround);
            // *pResult = CDRF_SKIPDEFAULT;
            // return;
            *pResult = CDRF_DODEFAULT;
            return;
        }
    }

    *pResult = CDRF_DODEFAULT;
}
