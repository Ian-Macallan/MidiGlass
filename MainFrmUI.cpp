
#include "stdafx.h"
#include "MidiGlassApp.h"

#include "MainFrm.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#undef THIS_FILE
static char THIS_FILE[] = __FILE__;
#endif

extern	CMidiWorksApp		theApp;

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentStopIe(CCmdUI* pCmdUI) 
{
	//
	// pCmdUI->Enable ( m_RightBrowserView != NULL );		

}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSave(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSaveAs(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFilePrint(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileTrace(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFilePrintPreview(CCmdUI* pCmdUI) 
{
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSendMail(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	pCmdUI->Enable ( FALSE );
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::DisableMenuWhenNoMidifile(CCmdUI *pCmdUI)
{
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile != NULL );

}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileAddtotheplaylist(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectAddGmreset(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectAddGsreset(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectAll(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectEndoftrack(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectFiltertracks(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectKeysignature(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectMoveAll(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectStartoftrack(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectTimesignature(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveControllerBankselecthigh(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveControllerBankselectlow(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveCopyright(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveCuepoint(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveInstrumentname(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveLyrics(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveMarkers(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveResetallcontrolers(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveSequence(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveSequencer(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveSystemexclusive(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveText(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateRemoveTrackname(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewStatusBar(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( m_wndStatusBar.GetStyle () & WS_VISIBLE ? 1 : 0 );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateIndicatorError(CCmdUI *pCmdUI)
{
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	const char			*pString;

    pCmdUI->Enable(); 

	//		Then look current document
	if ( pMididoc != NULL )
	{

		if ( pMidifile != NULL )
		{
			pString = pMidifile->GetLastErrorText ();
			if ( pString != NULL )
			{
				pCmdUI->SetText( pString );
			}
			else
			{
				pCmdUI->SetText( "No Error" ); 
			}
		}
		else
		{
			pCmdUI->SetText( "No Error" ); 
		}
	}
	else
	{
		pCmdUI->SetText( "No Error" ); 
	}
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerPlayll(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsStopped () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerStopll(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsPlaying () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerForwardll(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsPlaying () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerBackwardll(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsPlaying () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerPausell(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsPaused () || pMidifile->LLIsPlaying () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerPlayandloopll(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsStopped () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerPlay(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( ! pMidifile->MciIsPlaying () && ! pMidifile->LLIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerPlayandloop(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( ! pMidifile->MciIsPlaying () && ! pMidifile->LLIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerStop(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->MciIsPlaying () && ! pMidifile->LLIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSequencerResumell(CCmdUI* pCmdUI) 
{
	//
	CMidiDoc			*pMididoc	= GetMidiDoc ();
	CMidiFile			*pMidifile	= GetMidiFile ( );
	
	//		Correct all parameters
	if ( pMididoc == NULL || pMidifile == NULL )
	{
		pCmdUI->Enable ( FALSE );
		return;
	}

	pCmdUI->Enable ( pMidifile->LLIsPaused () && ! pMidifile->MciIsPlaying () );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewMciToolBar(CCmdUI *pCmdUI)
{
	pCmdUI->SetCheck ( IsMciBarVisible ( ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewMidiToolBar(CCmdUI *pCmdUI)
{
	pCmdUI->SetCheck ( IsMidiBarVisible ( )  );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewMaintoolbar(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsMainBarVisible ( )  );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewIetoolbar(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsIeBarVisible ( ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectTruncateNote(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentTracksList(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_LeftTrackView) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentMidiexplorer(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_LeftExplorerView ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentChannels(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightChannelView ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentHeader(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightGeneralView ) );
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentNotes(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightNotesView ) );
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentPlayer(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightPlayerView ) );
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentPlaylist(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightPlayListView ) );
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentStaff(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightStaffView ) );
}

void CMainFrame::OnUpdateContentTracks(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightEventView ) );
}

void CMainFrame::OnUpdateContentErrormessages(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->SetCheck ( IsViewPresentAndVisible ( pCmdUI, m_RightErrorView ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateContentEventsShowhide(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->Enable ( m_RightTextView != NULL && ! theApp.m_bSplitterWindow );	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateCorrectAddXgreset(CCmdUI* pCmdUI) 
{
	//
	DisableMenuWhenNoMidifile(pCmdUI);
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateEditFindagain(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->Enable ( IsViewPresentAndVisible ( pCmdUI, m_RightEventView ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateEditFind(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->Enable ( IsViewPresentAndVisible ( pCmdUI, m_RightEventView ) );
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileSavegeometry(CCmdUI* pCmdUI) 
{
	//
	pCmdUI->Enable ( ! theApp.m_bSplitterWindow );
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
bool CMainFrame::IsViewPresentAndVisible(CCmdUI *pCmdUI, CView *pView)
{
	if ( pView == NULL )
	{
		return false;
	}

	return ( pView->IsWindowVisible ( ) != FALSE );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateFileRecord(CCmdUI* pCmdUI) 
{
	//
	
	DisableMenuWhenNoMidifile(pCmdUI);
	
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMainFrame::OnUpdateViewSF2Toolbar(CCmdUI *pCmdUI)
{
	pCmdUI->SetCheck ( IsSF2BarVisible ( ) );
}
