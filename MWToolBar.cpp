//
///////////////////////////////////////////////////////////////////////////////////
// MWToolBar.cpp: implementation of the CMWToolBar class.
//
///////////////////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "MidiGlassApp.h"
#include "MWToolBar.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

extern CMidiWorksApp theApp;

//
///////////////////////////////////////////////////////////////////////////////////
// Construction/Destruction
//
///////////////////////////////////////////////////////////////////////////////////

IMPLEMENT_DYNAMIC(CMWToolBar, CToolBar)

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
BEGIN_MESSAGE_MAP(CMWToolBar, CToolBar)
	//{{AFX_MSG_MAP(CMWToolBar)
	//}}AFX_MSG_MAP
END_MESSAGE_MAP()

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
CMWToolBar::CMWToolBar()
{
	m_pFont			= NULL;
	m_bSendNormal	= false;
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
CMWToolBar::~CMWToolBar()
{
	if ( m_pFont != NULL )
	{
		delete m_pFont;
		m_pFont = NULL;
	}
}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWToolBar::SetAnsiVarFont()
{
	CFont		*pFont;
	LOGFONT		logFont;

	pFont = GetFont ( );
	pFont->GetLogFont ( & logFont );

	if ( m_pFont != NULL )
	{
		delete m_pFont;
		m_pFont = NULL;
	}

	logFont.lfWeight = FW_BOLD;
	m_pFont = new CFont ( );
	m_pFont->CreateFontIndirect ( &logFont );

}

//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWToolBar::SetAnsiFixedFont()
{
	CFont		*pFont;
	LOGFONT		logFont;

	pFont = GetFont ( );
	pFont->GetLogFont ( & logFont );

	if ( m_pFont != NULL )
	{
		delete m_pFont;
		m_pFont = NULL;
	}

	logFont.lfWeight = FW_BOLD;
	m_pFont = new CFont ( );
	m_pFont->CreateFontIndirect ( &logFont );
}


//
///////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////
void CMWToolBar::SendNormalMessage()
{
	m_bSendNormal	= true;
}

